---
title: "C++内存结构"
date: 2024-03-22
lastmod: 2024-03-22
author: "zhaohan"
tags:
  - C++
  - 计算机基础
---

# 1 整体结构

- **代码区**：包括代码段和只读数据段，用于存储程序的可执行指令和只读的常量数据。
- **常量区**：const修饰的变量，运行时不可改变。
- **全局/静态区**：程序启动时分配，程序结束时释放。全局变量区的数据可以被整个程序访问，静态变量区的数据仅声明的作用域内可见。
- **栈区**：由编译器自动分配与释放，存放运行时函数分配的局部变量、函数参数、返回数据、返回地址等。其操作类似于数据结构中的栈。
- **堆区**：由程序员分配，如果程序员没有释放，程序结束时可能有OS回收。其分配类似于链表。

# 2 访问速度和特点

C++中的不同内存区域（代码区、常量区、全局/静态区、栈区、堆区）具有不同的访问速度和特点。

- 代码区：代码区包含程序的可执行指令，通常位于只读存储器中。访问代码区的指令速度非常快，因为它通常位于高速缓存中，并且无需修改。因为代码区是只读的，所以它的访问速度非常高效。

- 常量区：常量区存储了const修饰的常量数据，这些数据在运行时不可修改。常量区的访问速度与代码区类似，因为它也通常位于只读存储器中，并且被认为是只读数据。

- 全局/静态区：全局变量区和静态变量区存储了全局变量和静态变量的数据。这些数据在程序启动时分配，在程序结束时释放。全局变量区和静态变量区的访问速度通常较快，因为它们在内存中的位置是固定的，并且可以直接访问。

- 栈区：栈区用于存储函数的局部变量、函数参数、返回数据和返回地址等。栈区的访问速度较快，因为它使用了栈结构，可以高效地分配和释放内存。栈区的访问是按照栈的先进后出（LIFO）规则进行的，使得局部变量的访问非常高效。

- 堆区：堆区用于动态分配内存，由程序员手动分配和释放。堆区的访问速度相对较慢，因为它的内存分配和释放需要更多的时间和开销。堆区的分配和释放是通过动态内存管理函数（如new和delete）来实现的，这些函数可能涉及更复杂的内存管理机制，导致访问速度较慢。

总的来说，代码区和常量区的访问速度较快，全局/静态区和栈区的访问速度也较快，而堆区的访问速度相对较慢。因此，在编写高性能的程序时，应尽量减少对堆区的频繁访问，避免不必要的动态内存分配和释放，以提高程序的执行效率。
